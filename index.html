<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For Dasha ‚ù§Ô∏è</title>
<style>
body{
    margin:0;
    overflow:hidden;
    background:black;
    font-family:Arial, sans-serif;
}

#message{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    color:white;
    text-align:center;
    font-size:28px;
    max-width:90%;
    line-height:1.6;
    opacity:0;
    transition:opacity 2s ease;
}

canvas{ display:block; }
</style>
</head>
<body>

<div id="message">
    <div>–î–∞—à–∞, —Å—å–æ–≥–æ–¥–Ω—ñ —è —Ö–æ—á—É</div>
    <div style="font-size:34px;color:#ff66cc;">–ø–æ–¥–∞—Ä—É–≤–∞—Ç–∏ —Ç–æ–±—ñ –≤—Å–µ—Å–≤—ñ—Ç.</div>
    <div>–¢–∏ –Ω–∞–π–∫—Ä–∞—â–∞ —ñ —è —Ç–µ–±–µ –ª—é–±–ª—é ‚ù§Ô∏è</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/loaders/FontLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/geometries/TextGeometry.js"></script>

<script>
let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 2000);
camera.position.z = 200;

let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio,2));
document.body.appendChild(renderer.domElement);

// ‚≠ê Stars
let starGeo = new THREE.BufferGeometry();
let starCount = 2000;
let starPos = new Float32Array(starCount*3);

for(let i=0;i<starCount;i++){
    starPos[i*3]=(Math.random()-0.5)*1500;
    starPos[i*3+1]=(Math.random()-0.5)*1500;
    starPos[i*3+2]=(Math.random()-0.5)*1500;
}
starGeo.setAttribute('position', new THREE.BufferAttribute(starPos,3));
let starMat = new THREE.PointsMaterial({color:0xffffff,size:1});
let stars = new THREE.Points(starGeo,starMat);
scene.add(stars);

// ‚ù§Ô∏è Heart group
let heartGroup = new THREE.Group();
scene.add(heartGroup);

let loader = new THREE.FontLoader();
loader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function(font){

    for(let t=0;t<Math.PI*2;t+=0.18){

        let x = 16*Math.pow(Math.sin(t),3);
        let y = 13*Math.cos(t)
              -5*Math.cos(2*t)
              -2*Math.cos(3*t)
              -Math.cos(4*t);

        let geo = new THREE.TextGeometry("I LOVE YOU",{
            font:font,
            size:2,
            height:0.4
        });

        geo.center();

        let mat = new THREE.MeshBasicMaterial({color:0xff66cc});
        let mesh = new THREE.Mesh(geo,mat);

        mesh.position.set(x*4,y*4,Math.sin(t)*18);
        mesh.lookAt(0,0,0);

        heartGroup.add(mesh);
    }

    heartGroup.visible = false;
});

// üéÜ Fireworks (optimized)
let fireworkParticles = [];

function launchFirework(){
    let geometry = new THREE.BufferGeometry();
    let count = 120;
    let positions = new Float32Array(count*3);
    let velocities = [];

    for(let i=0;i<count;i++){
        positions[i*3]=0;
        positions[i*3+1]=0;
        positions[i*3+2]=0;

        velocities.push({
            x:(Math.random()-0.5)*4,
            y:(Math.random()-0.5)*4,
            z:(Math.random()-0.5)*4
        });
    }

    geometry.setAttribute('position', new THREE.BufferAttribute(positions,3));
    let material = new THREE.PointsMaterial({
        color:0xffccff,
        size:2
    });

    let points = new THREE.Points(geometry,material);
    heartGroup.add(points);

    fireworkParticles.push({
        mesh:points,
        velocities:velocities,
        life:80
    });
}

renderer.domElement.addEventListener("click", launchFirework);
renderer.domElement.addEventListener("touchstart", launchFirework);

let clock = new THREE.Clock();
let messageDiv = document.getElementById("message");

function animate(){
    requestAnimationFrame(animate);

    let t = clock.getElapsedTime();
    stars.rotation.y += 0.0005;

    // Message timing
    if(t<2) messageDiv.style.opacity = t/2;
    else if(t<12) messageDiv.style.opacity = 1;
    else if(t<15) messageDiv.style.opacity = 1-(t-12)/3;
    else{
        messageDiv.style.display="none";
        heartGroup.visible = true;
        heartGroup.rotation.y += 0.01;
        heartGroup.rotation.x = Math.sin(t)*0.15;

        let scale = 1+Math.sin(t*3)*0.05;
        heartGroup.scale.set(scale,scale,scale);
    }

    // Update fireworks
    fireworkParticles.forEach((fw,index)=>{
        let positions = fw.mesh.geometry.attributes.position.array;

        fw.velocities.forEach((v,i)=>{
            positions[i*3]+=v.x;
            positions[i*3+1]+=v.y;
            positions[i*3+2]+=v.z;
        });

        fw.mesh.geometry.attributes.position.needsUpdate=true;
        fw.life--;

        if(fw.life<=0){
            heartGroup.remove(fw.mesh);
            fireworkParticles.splice(index,1);
        }
    });

    renderer.render(scene,camera);
}

animate();

window.addEventListener("resize",()=>{
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
